@(template: (GuidesPage, (GuidesData, List[GuidesPage])), page: utils.search.ItemPage[(Any,utils.search.SearchHit)], params: utils.search.SearchParams)(implicit userOpt: Option[UserProfile], request: RequestHeader, prefs: utils.SessionPrefs, globalConfig: global.GlobalConfig, lang: Lang, flash: Flash)


<ul class="list-item hierarchy">
    @page.items.map { case(item, hit) =>
        @defining(Some(hit.id)) { implicit descriptionId =>
            <li class="item-wrapper">
                @item match {
                    case d: DocumentaryUnit => {
                        ""
                    }
                    case d: HistoricalAgent => {
                        <a class="item-title">@d.toStringLang</a>
                    }
                    case d: Concept => {
                        <span class="item-title keyword-title">
                            @d.broaderTerms.map { bt =>
                                <span class="item-parent">
                                    @bt.toStringLang
                                </span>
                            }
                            @template._1.layout match { 
                                case "organisation" => {
                                    @if(d.childCount.getOrElse(0) > 0) {
                                        <a href="controllers.portal.routes.Guides.layoutRetrieval(template._2._1.path, template._1.path), template._1.layout)?parent=@d.id">
                                    } else {
                                        <a>
                                    }
                                } 
                                case _ => {
                                    <a>
                                }
                            }
                                @d.toStringLang
                            </a>
                        </span>
                    }
                    case _ => {
                        ""
                    }
                }
        }
        </li>

    }
</ul>